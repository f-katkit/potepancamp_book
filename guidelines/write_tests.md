# テストを書こう

テストを書くことで、プログラムが仕様通り動作することを保証することができます。

つまり「つくった機能が想定通りに動く」ことをテストコードが伝えてくれるので、安心して承認しやすいPRになります。

またテストは「未来の改修でうっかりその機能が動かなくなる」という事故も防いでくれます。

サービスのコードは常に成長し続けます。数万行、数十万行になったプログラムは、時として「何をさわったらどこが壊れるか想像もつかない」という積み木細工のような状態になることがあります。

重要な部分のテストが書かれていると、テストをすべてパスすることが１つの動作保証になるため、将来の改修時にも安心して作業ができます。（自分自身が救われます！）

### ポテパンでテストを勧める理由

ポテパンでは実際の開発のシミュレーションとしてテストを書くことを強くオススメしています。

* 実際のサービス開発では（とくに重要な機能については）テストがあることが一般的です。機能を追加する場合は、テストをセットで作成することが求められる現場も珍しくありません。

* 自動テスト（CI）環境がある現場も一般的です。PR時・マージ時に、過去から積み上げられてきた大量のテストを全て通過させることで、改修によってアプリケーションが壊れていないことを自動で確認できます。

* 開発現場には、仕様書やドキュメントがないことが普通にあります。テストを読み書きできれば、仕様を正しく把握したり記述することができます。

* 現場によってはちゃんとしたテストが書けるかどうかということがチームに加わるための選考基準になっていることもあります。

* 開発現場で慣れないテストを書くのは大変なものです。今のうちに書けるようになっておきましょう。

### テストを書こう

Rubyのテストフレームワークとしては、RSpecかminitestが一般的です。チュートリアルではminitestを書いたかと思いますが、最近のRailsアプリケーション開発においてはRSpecが多数派の印象です。

RSpecを導入したら、まずモデルやコントローラーの単体テストから始めてみましょう。
慣れてきたら、統合テスト（主にfeature spec）にもぜひ挑戦してみてください。

RSpecを学ぶための良い資料としては以下のようなものがあります。

* [Everyday Rails - RSpecによるRailsテスト入門](https://leanpub.com/everydayrailsrspec-jp) 

* 訳者の一人である伊藤淳一さんによる[Qiita記事](https://qiita.com/jnchito/items/42193d066bd61c740612)もよくまとまっているのでおすすめです

* 英語とRSpec文法が中心のため少し大変ですが、[オフィシャルドキュメント](https://relishapp.com/rspec/rspec-rails/docs)にも詳しい説明が書いてあるので参考にしてみてください。

* インストール方法などは[rspec-rails](https://github.com/rspec/rspec-rails)のオフィシャルリポジトリが参考になるかと思います。
